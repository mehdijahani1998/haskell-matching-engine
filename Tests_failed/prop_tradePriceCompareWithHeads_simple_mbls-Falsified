mesal naghz baraye vizhegie moghayese gheymate akharin trade anjam shode ba sare safe kharid va forooush.
dar in mesal akharin trade hameye order buy ke dar saf boode ast ra masraf karde va khodash ham tamam shodeh.

*ME> quickCheck (withMaxSuccess 10000 prop_tradePriceCompareWithHeads_simple_mbls) 
*** Failed! Falsifiable (after 3382 tests):

LimitOrder 10 147 958 Sell (Just 712)

OrderBook 

buyQ = [LimitOrder 3 923 541 Buy (Just 112) ,LimitOrder 4 285 417 Buy (Just 88) ,LimitOrder 4 490 958 Buy (Just 4) ,LimitOrder 3 480 620 Buy (Just 226) ,LimitOrder 4 512 428 Buy (Just 123) ,LimitOrder 4 515 255 Buy (Just 1) ,LimitOrder 9 764 760 Buy (Just 184) ,LimitOrder 9 762 933 Buy (Just 488) ,LimitOrder 9 217 405 Buy (Just 220) ,LimitOrder 9 491 924 Buy (Just 655) ,LimitOrder 5 456 631 Buy (Just 454) ,LimitOrder 10 521 912 Buy (Just 656) ,LimitOrder 5 387 877 Buy (Just 593) ,LimitOrder 10 671 682 Buy (Just 218) ,LimitOrder 9 815 968 Buy (Just 755) ,LimitOrder 10 213 992 Buy (Just 8) ,LimitOrder 10 840 707 Buy (Just 330) ,LimitOrder 1 581 341 Buy (Just 296) ,LimitOrder 5 482 623 Buy (Just 62) ,LimitOrder 4 20 772 Buy (Just 511) ,LimitOrder 3 90 987 Buy (Just 383) ,LimitOrder 8 302 692 Buy (Just 32) ,LimitOrder 2 140 692 Buy (Just 207) ,LimitOrder 4 205 649 Buy (Just 57) ,LimitOrder 3 357 837 Buy (Just 97) ,LimitOrder 7 886 210 Buy (Just 145) ,LimitOrder 4 817 911 Buy (Just 457) ,LimitOrder 10 77 593 Buy (Just 334) ,LimitOrder 1 828 476 Buy (Just 262) ,LimitOrder 8 295 842 Buy (Just 683) ,LimitOrder 3 985 921 Buy (Just 912) ,LimitOrder 4 265 583 Buy (Just 560) ,LimitOrder 9 23 938 Buy (Just 810) ,LimitOrder 5 693 993 Buy (Just 629) ,LimitOrder 4 106 514 Buy (Just 187) ,LimitOrder 6 942 755 Buy (Just 264) ,LimitOrder 7 127 938 Buy (Just 553) ,LimitOrder 8 510 604 Buy (Just 368) ,LimitOrder 9 778 978 Buy (Just 210) ,LimitOrder 8 373 635 Buy (Just 141) ,LimitOrder 4 161 115 Buy (Just 52) ,LimitOrder 6 982 430 Buy (Just 341) ,LimitOrder 6 328 930 Buy (Just 731) ,LimitOrder 5 909 788 Buy (Just 612) ,LimitOrder 6 389 430 Buy (Just 364) ,LimitOrder 3 52 715 Buy (Just 174) ,LimitOrder 5 992 554 Buy (Just 120) ,LimitOrder 3 744 929 Buy (Just 514) ,LimitOrder 3 950 200 Buy (Just 131) ,LimitOrder 10 628 798 Buy (Just 372) ,LimitOrder 4 337 869 Buy (Just 711) ,LimitOrder 10 331 405 Buy (Just 154) ,LimitOrder 2 660 925 Buy (Just 533) ,LimitOrder 1 203 436 Buy (Just 417) ,LimitOrder 10 691 651 Buy (Just 542) ,LimitOrder 1 721 858 Buy (Just 226) ,LimitOrder 2 999 507 Buy (Just 25) ,LimitOrder 3 309 532 Buy (Just 100) ,LimitOrder 4 241 885 Buy (Just 62) ,LimitOrder 5 369 477 Buy (Just 93)] 


sellQ = [LimitOrder 7 221 733 Sell (Just 246) ,LimitOrder 5 25 504 Sell (Just 217) ,LimitOrder 7 678 840 Sell (Just 532) ,LimitOrder 10 128 537 Sell (Just 178) ,LimitOrder 2 726 751 Sell (Just 545) ,LimitOrder 9 450 638 Sell (Just 193) ,LimitOrder 7 546 509 Sell (Just 345) ,LimitOrder 9 113 816 Sell (Just 375) ,LimitOrder 9 84 900 Sell (Just 488) ,LimitOrder 3 760 482 Sell (Just 275) ,LimitOrder 9 972 25 Sell (Just 19) ,LimitOrder 4 702 835 Sell (Just 420)]




*ME> matchNewOrder lm1 ob

(OrderBook {

buyQueue = [LimitOrder {oid = 4, price = 490, quantity = 958, side = Buy, minQty = Just 4},LimitOrder {oid = 3, price = 480, quantity = 620, side = Buy, minQty = Just 226},LimitOrder {oid = 4, price = 512, quantity = 428, side = Buy, minQty = Just 123},LimitOrder {oid = 4, price = 515, quantity = 255, side = Buy, minQty = Just 1},LimitOrder {oid = 9, price = 764, quantity = 760, side = Buy, minQty = Just 184},LimitOrder {oid = 9, price = 762, quantity = 933, side = Buy, minQty = Just 488},LimitOrder {oid = 9, price = 217, quantity = 405, side = Buy, minQty = Just 220},LimitOrder {oid = 9, price = 491, quantity = 924, side = Buy, minQty = Just 655},LimitOrder {oid = 5, price = 456, quantity = 631, side = Buy, minQty = Just 454},LimitOrder {oid = 10, price = 521, quantity = 912, side = Buy, minQty = Just 656},LimitOrder {oid = 5, price = 387, quantity = 877, side = Buy, minQty = Just 593},LimitOrder {oid = 10, price = 671, quantity = 682, side = Buy, minQty = Just 218},LimitOrder {oid = 9, price = 815, quantity = 968, side = Buy, minQty = Just 755},LimitOrder {oid = 10, price = 213, quantity = 992, side = Buy, minQty = Just 8},LimitOrder {oid = 10, price = 840, quantity = 707, side = Buy, minQty = Just 330},LimitOrder {oid = 1, price = 581, quantity = 341, side = Buy, minQty = Just 296},LimitOrder {oid = 5, price = 482, quantity = 623, side = Buy, minQty = Just 62},LimitOrder {oid = 4, price = 20, quantity = 772, side = Buy, minQty = Just 511},LimitOrder {oid = 3, price = 90, quantity = 987, side = Buy, minQty = Just 383},LimitOrder {oid = 8, price = 302, quantity = 692, side = Buy, minQty = Just 32},LimitOrder {oid = 2, price = 140, quantity = 692, side = Buy, minQty = Just 207},LimitOrder {oid = 4, price = 205, quantity = 649, side = Buy, minQty = Just 57},LimitOrder {oid = 3, price = 357, quantity = 837, side = Buy, minQty = Just 97},LimitOrder {oid = 7, price = 886, quantity = 210, side = Buy, minQty = Just 145},LimitOrder {oid = 4, price = 817, quantity = 911, side = Buy, minQty = Just 457},LimitOrder {oid = 10, price = 77, quantity = 593, side = Buy, minQty = Just 334},LimitOrder {oid = 1, price = 828, quantity = 476, side = Buy, minQty = Just 262},LimitOrder {oid = 8, price = 295, quantity = 842, side = Buy, minQty = Just 683},LimitOrder {oid = 3, price = 985, quantity = 921, side = Buy, minQty = Just 912},LimitOrder {oid = 4, price = 265, quantity = 583, side = Buy, minQty = Just 560},LimitOrder {oid = 9, price = 23, quantity = 938, side = Buy, minQty = Just 810},LimitOrder {oid = 5, price = 693, quantity = 993, side = Buy, minQty = Just 629},LimitOrder {oid = 4, price = 106, quantity = 514, side = Buy, minQty = Just 187},LimitOrder {oid = 6, price = 942, quantity = 755, side = Buy, minQty = Just 264},LimitOrder {oid = 7, price = 127, quantity = 938, side = Buy, minQty = Just 553},LimitOrder {oid = 8, price = 510, quantity = 604, side = Buy, minQty = Just 368},LimitOrder {oid = 9, price = 778, quantity = 978, side = Buy, minQty = Just 210},LimitOrder {oid = 8, price = 373, quantity = 635, side = Buy, minQty = Just 141},LimitOrder {oid = 4, price = 161, quantity = 115, side = Buy, minQty = Just 52},LimitOrder {oid = 6, price = 982, quantity = 430, side = Buy, minQty = Just 341},LimitOrder {oid = 6, price = 328, quantity = 930, side = Buy, minQty = Just 731},LimitOrder {oid = 5, price = 909, quantity = 788, side = Buy, minQty = Just 612},LimitOrder {oid = 6, price = 389, quantity = 430, side = Buy, minQty = Just 364},LimitOrder {oid = 3, price = 52, quantity = 715, side = Buy, minQty = Just 174},LimitOrder {oid = 5, price = 992, quantity = 554, side = Buy, minQty = Just 120},LimitOrder {oid = 3, price = 744, quantity = 929, side = Buy, minQty = Just 514},LimitOrder {oid = 3, price = 950, quantity = 200, side = Buy, minQty = Just 131},LimitOrder {oid = 10, price = 628, quantity = 798, side = Buy, minQty = Just 372},LimitOrder {oid = 4, price = 337, quantity = 869, side = Buy, minQty = Just 711},LimitOrder {oid = 10, price = 331, quantity = 405, side = Buy, minQty = Just 154},LimitOrder {oid = 2, price = 660, quantity = 925, side = Buy, minQty = Just 533},LimitOrder {oid = 1, price = 203, quantity = 436, side = Buy, minQty = Just 417},LimitOrder {oid = 10, price = 691, quantity = 651, side = Buy, minQty = Just 542},LimitOrder {oid = 1, price = 721, quantity = 858, side = Buy, minQty = Just 226},LimitOrder {oid = 2, price = 999, quantity = 507, side = Buy, minQty = Just 25},LimitOrder {oid = 3, price = 309, quantity = 532, side = Buy, minQty = Just 100},LimitOrder {oid = 4, price = 241, quantity = 885, side = Buy, minQty = Just 62},LimitOrder {oid = 5, price = 369, quantity = 477, side = Buy, minQty = Just 93}], 

sellQueue = [LimitOrder {oid = 7, price = 221, quantity = 733, side = Sell, minQty = Just 246},LimitOrder {oid = 5, price = 25, quantity = 504, side = Sell, minQty = Just 217},LimitOrder {oid = 7, price = 678, quantity = 840, side = Sell, minQty = Just 532},LimitOrder {oid = 10, price = 128, quantity = 537, side = Sell, minQty = Just 178},LimitOrder {oid = 2, price = 726, quantity = 751, side = Sell, minQty = Just 545},LimitOrder {oid = 9, price = 450, quantity = 638, side = Sell, minQty = Just 193},LimitOrder {oid = 7, price = 546, quantity = 509, side = Sell, minQty = Just 345},LimitOrder {oid = 9, price = 113, quantity = 816, side = Sell, minQty = Just 375},LimitOrder {oid = 9, price = 84, quantity = 900, side = Sell, minQty = Just 488},LimitOrder {oid = 3, price = 760, quantity = 482, side = Sell, minQty = Just 275},LimitOrder {oid = 9, price = 972, quantity = 25, side = Sell, minQty = Just 19},LimitOrder {oid = 4, price = 702, quantity = 835, side = Sell, minQty = Just 420}]},

[Trade {priceTraded = 923, quantityTraded = 541, buyId = 3, sellId = 10},Trade {priceTraded = 285, quantityTraded = 417, buyId = 4, sellId = 10}])